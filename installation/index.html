
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Overview, guides, reference documentation and other resources for Trino Gateway.">
      
      
        <meta name="author" content="Trino Gateway contributors">
      
      
        <link rel="canonical" href="https://trinodb.github.io/trino-gateway/installation/">
      
      
        <link rel="prev" href="../quickstart/">
      
      
        <link rel="next" href="../operation/">
      
      
        
      
      
      <link rel="icon" href="../assets/logos/trino-favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Installation - Trino Gateway</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="Installation - Trino Gateway" />
<meta property="og:description" content="Overview, guides, reference documentation and other resources for Trino Gateway." />
<meta property="og:image" content="https://trinodb.github.io/trino-gateway/assets/images/social/installation.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://trinodb.github.io/trino-gateway/installation/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="Installation - Trino Gateway" />
<meta property="twitter:description" content="Overview, guides, reference documentation and other resources for Trino Gateway." />
<meta property="twitter:image" content="https://trinodb.github.io/trino-gateway/assets/images/social/installation.png" />
</head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Trino Gateway" class="md-header__button md-logo" aria-label="Trino Gateway" data-md-component="logo">
      
  <img src="../assets/logos/trino.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Trino Gateway
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Installation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/trinodb/trino-gateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    trinodb/trino-gateway
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../quickstart/" class="md-tabs__link">
          
  
  
    
  
  Get started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../routing-rules/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../development/" class="md-tabs__link">
          
  
  
    
  
  Contribute

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Trino Gateway" class="md-nav__button md-logo" aria-label="Trino Gateway" data-md-component="logo">
      
  <img src="../assets/logos/trino.svg" alt="logo">

    </a>
    Trino Gateway
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/trinodb/trino-gateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    trinodb/trino-gateway
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../users/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Users
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Get started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Get started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Operating system
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processor-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Processor architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend database
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trino-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trino clusters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trino-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trino configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secrets-in-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secrets in configuration file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-routing-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure routing rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxying-additional-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxying additional paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-additional-v1statement-like-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure additional v1/statement-like paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deactivate-ui-pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deactivate UI pages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-behind-a-load-balancer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure behind a load balancer
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-larger-proxy-response-size" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure larger proxy response size
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-trino-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running Trino Gateway
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Trino Gateway">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helm
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional options
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-checks-on-trino-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health checks on Trino clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Health checks on Trino clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#info_api-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        INFO_API (default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        METRICS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdbc" class="md-nav__link">
    <span class="md-ellipsis">
      
        JDBC
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jmx" class="md-nav__link">
    <span class="md-ellipsis">
      
        JMX
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ui_api" class="md-nav__link">
    <span class="md-ellipsis">
      
        UI_API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noop" class="md-nav__link">
    <span class="md-ellipsis">
      
        NOOP
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../routing-rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../routing-logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing logic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gateway-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gateway API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resource-groups-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resource groups API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration-to-airlift/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migration to Airlift
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contribute
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contribute
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../routers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Operating system
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processor-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Processor architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend database
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trino-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trino clusters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trino-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trino configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secrets-in-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secrets in configuration file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-routing-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure routing rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxying-additional-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxying additional paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-additional-v1statement-like-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure additional v1/statement-like paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deactivate-ui-pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deactivate UI pages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-behind-a-load-balancer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure behind a load balancer
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-larger-proxy-response-size" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure larger proxy response size
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-trino-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running Trino Gateway
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Trino Gateway">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helm
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional options
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-checks-on-trino-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health checks on Trino clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Health checks on Trino clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#info_api-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        INFO_API (default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        METRICS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdbc" class="md-nav__link">
    <span class="md-ellipsis">
      
        JDBC
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jmx" class="md-nav__link">
    <span class="md-ellipsis">
      
        JMX
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ui_api" class="md-nav__link">
    <span class="md-ellipsis">
      
        UI_API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noop" class="md-nav__link">
    <span class="md-ellipsis">
      
        NOOP
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/trinodb/trino-gateway/edit/main/docs/installation.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/trinodb/trino-gateway/raw/main/docs/installation.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h1>
<p>Trino Gateway is distributed as an executable JAR file. The <a href="../release-notes/">release
notes</a> contain links to download specific versions.</p>
<p>Every Trino Gateway release includes a <a href="../docker/">Docker container</a> and a 
<a href="./#helm">Helm chart</a> as alternative deployment methods.</p>
<p>Follow the <a href="../development/">development instructions</a> to
build the JAR file and the Docker image instructions  or use the 
<code>TrinoGatewayRunner</code> class for local testing.
The <a href="../quickstart/">quickstart guide</a> contains instructions for running the
application locally.</p>
<p>Following are instructions for installing Trino Gateway for production
environments.</p>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>Consider the following requirements for your Trino Gateway installation.</p>
<h3 id="java">Java<a class="headerlink" href="#java" title="Permanent link">&para;</a></h3>
<p>Trino Gateway requires a Java 25 runtime. Older versions of Java can not be
used. Newer versions might work but are not tested.</p>
<p>Verify the Java version on your system with <code>java -version</code>.</p>
<h3 id="operating-system">Operating system<a class="headerlink" href="#operating-system" title="Permanent link">&para;</a></h3>
<p>No specific operating system is required. All testing and development is
performed with Linux and MacOS.</p>
<h3 id="processor-architecture">Processor architecture<a class="headerlink" href="#processor-architecture" title="Permanent link">&para;</a></h3>
<p>No specific processor architecture is required, as long as a suitable Java
distribution is installed.  </p>
<h3 id="backend-database">Backend database<a class="headerlink" href="#backend-database" title="Permanent link">&para;</a></h3>
<p>Trino Gateway requires a MySQL, PostgreSQL, or Oracle database. Database
initialization is performed automatically when the Trino Gateway process
starts. Migrations are performed using <code>Flyway</code>.</p>
<p>The migration files can viewed in the <code>gateway-ha/src/main/resources/</code> folder.
Each database type supported has its own sub-folder.</p>
<p>The files are also included in the JAR file.</p>
<p>If you do not want migrations to be performed automatically on startup, then
you can set <code>runMigrationsEnabled</code> to <code>false</code> in the data store configuration.</p>
<p>You can also disable query history recording to the database by setting
<code>queryHistoryEnabled</code> to <code>false</code>. This can be useful in scenarios where you
want to reduce database load or don't need query history tracking.</p>
<p>For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">dataStore</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">jdbcUrl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jdbc:postgresql://postgres:5432/trino_gateway_db</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USER</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PASSWORD</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">org.postgresql.Driver</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">  </span><span class="nt">queryHistoryHoursRetention</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">  </span><span class="nt">runMigrationsEnabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="nt">queryHistoryEnabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Set to false to disable query history recording</span>
</span></code></pre></div>
<p><code>Flyway</code> uses a transactional lock in databases that support it such as 
<a href="https://documentation.red-gate.com/fd/postgresql-database-235241807.html#">PostgreSQL</a>.
In the scenario where multiple Trino Gateway instances are running and sharing
the same backend database, the first Trino Gateway instance to start will get
the lock and run the database migrations with <code>Flyway</code>. Other Trino Gateway
instances might fail during startup while migrations are running but once migrations
are completed they will start as expected.</p>
<h3 id="trino-clusters">Trino clusters<a class="headerlink" href="#trino-clusters" title="Permanent link">&para;</a></h3>
<p>The proxied Trino clusters behind the Trino Gateway must support the Trino JDBC
driver and the Trino REST API for cluster and node health information.
Typically, this means that Trino versions 354 and higher should work, however
newer Trino versions are strongly recommended.</p>
<p>Trino-derived projects and platforms may work if the Trino JDBC driver and the
REST API are supported. For example, Starburst Galaxy and Starburst Enterprise
are known to work. Trino deployments with the Helm chart and other means on
various cloud platforms, such as Amazon EKS also work. However Amazon Athena
does not work since it uses alternative, custom protocols and lacks the concept
of individual clusters.</p>
<h3 id="trino-configuration">Trino configuration<a class="headerlink" href="#trino-configuration" title="Permanent link">&para;</a></h3>
<p>From a users perspective Trino Gateway acts as a transparent proxy for one 
or more Trino clusters. The following Trino configuration tips should be 
taken into account for all clusters behind the Trino Gateway.</p>
<p>If all client and server communication is routed through Trino Gateway, 
then process forwarded HTTP headers must be enabled:</p>
<div class="language-properties highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="na">http-server.process-forwarded</span><span class="o">=</span><span class="s">true</span>
</span></code></pre></div>
<p>Without this setting, first requests go from the user to Trino Gateway and then
to Trino correctly. However, the URL for subsequent next URIs for more results
in a query provided by Trino is then using the local URL of the Trino cluster,
and not the URL of the Trino Gateway. This circumvents the Trino Gateway for all
these requests. In scenarios, where the local URL of the Trino cluster is private 
to the Trino cluster on the network level, these following calls do not work
at all for users.</p>
<p>This setting is also required for Trino to authenticate in the case TLS is 
terminated at the Trino Gateway. Normally it refuses to authenticate plain HTTP 
requests, but if <code>http-server.process-forwarded=true</code> it authenticates over 
HTTP if the request includes <code>X-Forwarded-Proto: HTTPS</code>.</p>
<p>To prevent Trino Gateway from sending <code>X-Forwarded-*</code> headers, add the following configuration:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nt">routing</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">addXForwardedHeaders</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div>
<p>Find more information in <a href="https://trino.io/docs/current/security/tls.html#use-a-load-balancer-to-terminate-tls-https">the related Trino documentation</a>.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>After downloading or building the JAR, rename it to <code>gateway-ha.jar</code>,
and place it in a directory with read and write access such as <code>/opt/trinogateway</code>.</p>
<p>Copy the example config file <code>config.yaml</code> from the <code>gateway-ha/</code>
directory into the same directory, and update the configuration as needed.</p>
<p>Each component of the Trino Gateway has a corresponding node in the
configuration YAML file.</p>
<h3 id="secrets-in-configuration-file">Secrets in configuration file<a class="headerlink" href="#secrets-in-configuration-file" title="Permanent link">&para;</a></h3>
<p>Environment variables can be used as values in the configuration file.
You can manually set an environment variable on the command line.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DB_PASSWORD</span><span class="o">=</span>my-super-secret-pwd
</span></code></pre></div>
<p>To use this variable in the configuration file, you reference it with the 
syntax <code>${ENV:VARIABLE}</code>. For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">dataStore</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">jdbcUrl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jdbc:postgresql://localhost:5432/gateway</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${ENV:DB_PASSWORD}</span>
</span></code></pre></div>
<h3 id="configure-routing-rules">Configure routing rules<a class="headerlink" href="#configure-routing-rules" title="Permanent link">&para;</a></h3>
<p>Find more information in the <a href="../routing-rules/">routing rules documentation</a>.</p>
<h3 id="configure-logging">Configure logging <a name="logging"><a class="headerlink" href="#configure-logging" title="Permanent link">&para;</a></h3>
<p>To configure the logging level for various classes, specify the path to the 
<code>log.properties</code> file by setting <code>log.levels-file</code> in <code>serverConfig</code>.</p>
<p>For additional configurations, use the <code>log.*</code> properties from the 
<a href="https://trino.io/docs/current/admin/properties-logging.html">Trino logging properties documentation</a> and specify
the properties in <code>serverConfig</code>.</p>
<h3 id="proxying-additional-paths">Proxying additional paths<a class="headerlink" href="#proxying-additional-paths" title="Permanent link">&para;</a></h3>
<p>By default, Trino Gateway only proxies requests to paths starting with
<code>/v1/statement</code>, <code>/v1/query</code>, <code>/ui</code>, <code>/v1/info</code>, <code>/v1/node</code>, <code>/ui/api/stats</code> and
<code>/oauth</code>.</p>
<p>If you want to proxy additional paths, you can add them by adding the
<code>extraWhitelistPaths</code> node to your configuration YAML file.
Trino Gateway takes regexes from <code>extraWhitelistPaths</code> and forwards only
those requests with a URI that exactly match. Be sure
to use single-quoted strings so that escaping is not required.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">extraWhitelistPaths</span><span class="p">:</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/ui/insights&#39;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/api/v1/biac&#39;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/api/v1/dataProduct&#39;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/api/v1/dataproduct&#39;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/api/v2/.*&#39;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/ext/faster&#39;</span>
</span></code></pre></div>
<h3 id="configure-additional-v1statement-like-paths">Configure additional v1/statement-like paths<a class="headerlink" href="#configure-additional-v1statement-like-paths" title="Permanent link">&para;</a></h3>
<p>The Trino client protocol specifies that queries are initiated by a POST to <code>v1/statement</code>. 
The Trino Gateway incorporates this into its routing logic by extracting and recording the 
query id from responses to such requests. If you use an experimental or commercial build of
Trino that supports additional endpoints, you can cause Trino Gateway to treat them 
equivalently to <code>/v1/statement</code> by adding them under the <code>additionalStatementPaths</code>
configuration node. They must be absolute, and no path can be a prefix to any other path.
The standard <code>/v1/statement</code> path is always included and does not need to be configured. 
For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">additionalStatementPaths</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/ui/api/insights/ide/statement&#39;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/v2/statement&#39;</span>
</span></code></pre></div>
<h3 id="deactivate-ui-pages">Deactivate UI pages<a class="headerlink" href="#deactivate-ui-pages" title="Permanent link">&para;</a></h3>
<p>You can set the <code>disablePages</code> configuration to deactivate UI pages.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nt">uiConfiguration</span><span class="p">:</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">  </span><span class="nt">disablePages</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;routing-rules&#39;</span>
</span></code></pre></div>
<p>The following pages are available:</p>
<ul>
<li><code>dashboard</code></li>
<li><code>cluster</code></li>
<li><code>resource-group</code></li>
<li><code>selector</code></li>
<li><code>history</code></li>
<li><code>routing-rules</code></li>
</ul>
<h2 id="configure-behind-a-load-balancer">Configure behind a load balancer<a class="headerlink" href="#configure-behind-a-load-balancer" title="Permanent link">&para;</a></h2>
<p>A possible deployment of Trino Gateway is to run multiple instances of Trino 
Gateway behind another generic load balancer, such as a load balancer from 
your cloud hosting provider. In this deployment you must configure the 
<code>serverConfig</code> to include enabling process forwarded HTTP headers:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">serverConfig</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">http-server.process-forwarded</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div>
<h2 id="configure-larger-proxy-response-size">Configure larger proxy response size<a class="headerlink" href="#configure-larger-proxy-response-size" title="Permanent link">&para;</a></h2>
<p>Trino Gateway reads the response from Trino in bytes (up to 32MB by default).
It can be configured by setting:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">proxyResponseConfiguration</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="nt">responseSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50MB</span>
</span></code></pre></div>
<h2 id="running-trino-gateway">Running Trino Gateway<a class="headerlink" href="#running-trino-gateway" title="Permanent link">&para;</a></h2>
<p>Start Trino Gateway with the following java command in the directory of the
JAR and YAML files:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>java<span class="w"> </span>-XX:MinRAMPercentage<span class="o">=</span><span class="m">50</span><span class="w"> </span>-XX:MaxRAMPercentage<span class="o">=</span><span class="m">80</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span>-jar<span class="w"> </span>gateway-ha.jar<span class="w"> </span>config.yaml
</span></code></pre></div>
<h3 id="helm">Helm <a name="helm"></a><a class="headerlink" href="#helm" title="Permanent link">&para;</a></h3>
<p>Helm manages the deployment of Kubernetes applications by templating Kubernetes
resources with a set of Helm charts. The Trino Gateway Helm chart is 
available in the <a href="https://github.com/trinodb/charts">Trino Helm chart project</a>.</p>
<p>Configure the charts repository as a Helm chart repository with the 
following command:</p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>trino<span class="w"> </span>https://trinodb.github.io/charts/
</span></code></pre></div>
The Trino Gateway chart consists of the following components:</p>
<ul>
<li>A <code>config</code> node for general configuration</li>
<li><code>dataStoreSecret</code>, <code>backendStateSecret</code> and <code>authenticationSecret</code> for 
  providing sensitive configurations through Kubernetes secrets, </li>
<li>Standard Helm options such as <code>replicaCount</code>, <code>resources</code> and <code>ingress</code>.</li>
</ul>
<p>The default <code>values.yaml</code> found in the <code>helm/trino-gateway</code> folder includes
basic configuration options as an example. For a simple deployment, proceed with 
the following steps:</p>
<p>Create a yaml file containing the configuration for your <code>datastore</code>:</p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; datastore.yaml</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="s">dataStore:</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="s">   jdbcUrl: jdbc:postgresql://yourdatabasehost:5432/gateway</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="s">   user: postgres</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="s">   password: secretpassword</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="s">   driver: org.postgresql.Driver</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="s">EOF</span>
</span></code></pre></div>
Create a Kubernetes secret from this file:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>generic<span class="w"> </span>datastore-yaml<span class="w"> </span>--from-file<span class="w"> </span>datastore.yaml<span class="w"> </span>--dry-run<span class="o">=</span>client<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</span></code></pre></div>
<p>Create a values override with a name such as <code>values-override.yaml</code> and
reference this secret in the <code>backendStateSecret</code> node:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nt">backendStateSecret</span><span class="p">:</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;datastore-yaml&quot;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;datastore.yaml&quot;</span>
</span></code></pre></div>
<p>When a Secret is created with the <code>--from-file</code> option, the filename is used as
the key. Finally, you can deploy Trino Gateway with the chart from the root 
of this repository:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>helm<span class="w"> </span>install<span class="w"> </span>tg<span class="w"> </span>--values<span class="w"> </span>values-override.yaml<span class="w"> </span>trino/trino-gateway<span class="w"> </span>
</span></code></pre></div>
<p>Secrets for <code>authenticationSecret</code> and <code>backendState</code> can be provisioned
similarly. Alternatively,  you can directly define the <code>config.backEndState</code> 
node in <code>values-override.yaml</code> and leave <code>backendStateSecret</code> undefined. 
However, a <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a>
is recommended to protect the database credentials required for this 
configuration.</p>
<p>By default, the Trino Gateway process is started with the following command:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>java<span class="w"> </span>-XX:MinRAMPercentage<span class="o">=</span><span class="m">80</span>.0<span class="w"> </span>-XX:MaxRAMPercentage<span class="o">=</span><span class="m">80</span>.0<span class="w"> </span>-jar<span class="w"> </span>/usr/lib/trino-gateway/gateway-ha-jar-with-dependencies.jar<span class="w"> </span>/etc/trino-gateway/config.yaml
</span></code></pre></div>
<p>You can customize details with the <code>command</code> node. It accepts a list, that must
begin with an executable such as <code>java</code> or <code>bash</code> that is available on the PATH.
The following list elements are provided as arguments to the executable. It is
not typically necessary to modify this node. You can use it to change of JVM
startup parameters to control memory settings and other aspects, or to use other
configuration file names.</p>
<h4 id="additional-options">Additional options<a class="headerlink" href="#additional-options" title="Permanent link">&para;</a></h4>
<p>To implement routing rules, create a ConfigMap from your routing rules yaml
definition:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>cm<span class="w"> </span>routing-rules<span class="w"> </span>--from-file<span class="w"> </span>your-routing-rules.yaml
</span></code></pre></div>
<p>Then mount it to your container:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">      </span><span class="nt">configMap</span><span class="p">:</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">          </span><span class="nt">items</span><span class="p">:</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">              </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="nt">volumeMounts</span><span class="p">:</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/etc/routing-rules/your-routing-rules.yaml&quot;</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">      </span><span class="nt">subPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
</span></code></pre></div>
<p>Ensure that the <code>mountPath</code> matches the <code>rulesConfigPath</code> specified in your
configuration. Note that the <code>subPath</code> is not strictly necessary, and if it 
is not specified the file is mounted at <code>mountPath/&lt;configMap key&gt;</code>. 
Kubernetes updates the mounted file when the ConfigMap is updated.</p>
<p>Standard Helm options such as <code>replicaCount</code>, <code>image</code>, <code>imagePullSecrets</code>, 
<code>service</code>, <code>ingress</code> and <code>resources</code> are supported. These are defined in 
<code>helm/values.yaml</code>. </p>
<p>More detail about the chart are available in the <a href="https://github.com/trinodb/charts/blob/main/charts/gateway/README.md">values 
reference documentation</a></p>
<h3 id="health-checks-on-trino-clusters">Health checks on Trino clusters<a class="headerlink" href="#health-checks-on-trino-clusters" title="Permanent link">&para;</a></h3>
<p>The Trino Gateway periodically performs health checks and maintains
an in-memory TrinoStatus for each backend. If a backend fails a health check,
it is marked as UNHEALTHY, and the Trino Gateway stops routing requests to it.</p>
<p>It is important to distinguish TrinoStatus from the active/inactive
state of a backend. The active/inactive state indicates whether a backend is
manually turned on or off, whereas TrinoStatus is programmatically determined
by the health check process.</p>
<p>See <a href="../routing-rules/#trinostatus">TrinoStatus</a> for more details on 
what each Trino status means.</p>
<p>Username and password for the health check can be configured by adding 
<code>backendState</code> to your configuration. The username and password must be valid
across all backends.</p>
<p>SSL and xForwardProtoHeader can be configured based on whether the 
connection between the Trino Gateway and the backend is secure. 
By default, both are set to false.
Find more information in <a href="https://trino.io/docs/current/security/tls.html#use-a-load-balancer-to-terminate-tls-https">the related Trino documentation</a>.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">backendState</span><span class="p">:</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;user&quot;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;password&quot;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">  </span><span class="nt">ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;false/true&gt;</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">  </span><span class="nt">xForwardedProtoHeader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;false/true&gt;</span><span class="w">  </span>
</span></code></pre></div>
<p>The type of health check is configured by setting</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nt">clusterStatsConfiguration</span><span class="p">:</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nt">monitorType</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</span></code></pre></div>
<p>to one of the following values.</p>
<h4 id="info_api-default">INFO_API (default)<a class="headerlink" href="#info_api-default" title="Permanent link">&para;</a></h4>
<p>By default Trino Gateway uses the <code>v1/info</code> REST endpoint. A successful check is
defined as a 200 response with <code>starting: false</code>. Connection timeout parameters 
can be defined through the <code>monitor</code> node, for example</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="nt">connectTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">  </span><span class="nt">requestTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">  </span><span class="nt">idleTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">  </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span></code></pre></div>
<p>All timeout parameters are optional.</p>
<h4 id="metrics">METRICS<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h4>
<p>This pulls statistics from Trino's <a href="https://openmetrics.io/">OpenMetrics</a> endpoint.
It retrieves the number of running and queued queries for use with
the <code>QueryCountBasedRouter</code> (either <code>METRICS</code> or <code>JDBC</code> must be enabled if
<code>QueryCountBasedRouter</code> is used).</p>
<p>By default, it uses the <code>trino_execution_name_QueryManager_RunningQueries</code> and
<code>trino_execution_name_QueryManager_QueuedQueries</code> to track the number of running
and queued queries respectively, however these metrics can be configured as follows:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="nt">runningQueriesMetricName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_RunningQueries</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="nt">queuedQueriesMetricName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_QueuedQueries</span>
</span></code></pre></div>
<p>Similarly, by default the monitor pulls the metrics using the <code>/metrics</code> endpoint, but it
can be updated to use another one:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="nt">metricsEndpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/v1/metrics</span>
</span></code></pre></div>
<p>This monitor allows customizing health definitions by comparing metrics to fixed
values. This is configured through two maps: <code>metricMinimumValues</code> and 
<code>metricMaximumValues</code>. The keys of these maps are the metric names, and the values
are the minimum or maximum values (inclusive) that are considered healthy. By default,
the only metric populated is:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="nt">metricMinimumValues</span><span class="p">:</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">        </span><span class="nt">trino_metadata_name_DiscoveryNodeManager_ActiveNodeCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span></code></pre></div>
<p>This requires the cluster to have at least one active worker node in order to be considered
healthy. The map is overwritten if configured explicitly. For example, to increase the minimum
worker count to 10 and disqualify clusters that have been experiencing frequent major Garbage
Collections, set</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="nt">metricMinimumValues</span><span class="p">:</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">        </span><span class="nt">trino_metadata_name_DiscoveryNodeManager_ActiveNodeCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="nt">metricMaximumValues</span><span class="p">:</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">        </span><span class="nt">io_airlift_stats_name_GcMonitor_MajorGc_FiveMinutes_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span></code></pre></div>
<h4 id="jdbc">JDBC<a class="headerlink" href="#jdbc" title="Permanent link">&para;</a></h4>
<p>This uses a JDBC connection to query <code>system.runtime</code> tables for cluster 
information. It is required for the query count based routing strategy. This is
recommended over <code>UI_API</code> since it does not restrict the Web UI authentication
method of backend clusters. </p>
<p>Trino Gateway uses <code>explicitPrepare=false</code> by default. This property was introduced
in Trino 431, and uses a single query for prepared statements, instead of a 
<code>PREPARE/EXECUTE</code> pair. If you are using the JDBC health check option with older 
versions of Trino, set
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">   </span><span class="nt">explicitPrepare</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div></p>
<p>The query timeout can be set through</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nt">monitor</span><span class="p">:</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="nt">queryTimeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span></code></pre></div>
<p>Other timeout parameters are not applicable to the JDBC connection.</p>
<h4 id="jmx">JMX<a class="headerlink" href="#jmx" title="Permanent link">&para;</a></h4>
<p>The monitor type <code>JMX</code> can be used as an alternative to collect cluster information, 
which is required for the <code>QueryCountBasedRouterProvider</code>. This uses the <code>v1/jmx/mbean</code> 
endpoint on Trino clusters.</p>
<p>To enable this:</p>
<p><a href="https://trino.io/docs/current/admin/jmx.html">JMX monitoring</a> must be activated on all Trino clusters with:</p>
<div class="language-properties highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="na">jmx.rmiregistry.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="na">jmx.rmiserver.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
</span></code></pre></div>
<p>Allow JMX endpoint access by adding rules to your <a href="https://trino.io/docs/current/security/file-system-access-control.html">file-based access control</a>
configuration. Example for <code>user</code>:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="p">{</span><span class="w">  </span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="nt">&quot;catalogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;read-only&quot;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">  </span><span class="nt">&quot;system_information&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="p">}</span>
</span></code></pre></div>
<p>Ensure that a username and password are configured by adding the <code>backendState</code>
section to your configuration. The credentials must be consistent across all
backend clusters and have <code>read</code> rights on the <code>system_information</code>.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nt">backendState</span><span class="p">:</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;user&quot;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;password&quot;</span>
</span></code></pre></div>
<p>The JMX monitor will use these credentials to authenticate against the
JMX endpoint of each Trino cluster and collect metrics like running queries,
queued queries, and worker nodes information.</p>
<h4 id="ui_api">UI_API<a class="headerlink" href="#ui_api" title="Permanent link">&para;</a></h4>
<p>This pulls cluster information from the <code>ui/api/stats</code> REST endpoint. This is
supported for legacy reasons and may be deprecated in the future. It is only 
supported for backend clusters with <code>web-ui.authentication.type=FORM</code>. Set
a username and password using <code>backendState</code> as with the <code>JDBC</code> option.</p>
<h4 id="noop">NOOP<a class="headerlink" href="#noop" title="Permanent link">&para;</a></h4>
<p>This option disables health checks.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Trino Gateway is open source software licensed under the
<a href="https://github.com/trinodb/trino-gateway/blob/main/LICENSE">Apache License 2.0</a>
and supported by the <a href="https://trino.io/foundation.html">Trino Software Foundation</a>.

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/trinodb/trino-gateway" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/c/trinodb" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://trino.io/slack" target="_blank" rel="noopener" title="trino.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M94.1 315.1c0 25.9-21.2 47.1-47.1 47.1S0 341 0 315.1 21.2 268 47.1 268h47.1v47.1zm23.7 0c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1v117.8c0 25.9-21.2 47.1-47.1 47.1s-47.1-21.2-47.1-47.1zm47.1-189c-25.9 0-47.1-21.2-47.1-47.1s21.2-47 47.1-47S212 53.2 212 79.1v47.1h-47.1zm0 23.7c25.9 0 47.1 21.2 47.1 47.1S190.8 244 164.9 244H47.1C21.2 244 0 222.8 0 196.9s21.2-47.1 47.1-47.1zm189 47.1c0-25.9 21.2-47.1 47.1-47.1s47 21.2 47 47.1-21.2 47.1-47.1 47.1h-47.1v-47.1zm-23.7 0c0 25.9-21.2 47.1-47.1 47.1S236 222.8 236 196.9V79.1c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1zm-47.1 189c25.9 0 47.1 21.2 47.1 47.1s-21.2 47-47.1 47-47.1-21.2-47.1-47.1v-47.1h47.1zm0-23.7c-25.9 0-47.1-21.2-47.1-47.1s21.2-47.1 47.1-47.1h117.8c25.9 0 47.1 21.2 47.1 47.1s-21.2 47.1-47.1 47.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/trino-software-foundation" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../assets/js/extra.js"></script>
      
    
  </body>
</html>